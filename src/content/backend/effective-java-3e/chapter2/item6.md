# 불필요한 객체 생성을 피하라
#### \#1. 객체 재사용
- 똑같은 기능을 하는 객체는 매번 생성하기 보다는 객체 하나를 재사용하는 것이 나을때가 많다.
- 특히 불변 객체는 언제든 재사용이 가능하다.
- 생성자 대신 정적 팩토리 메소드를 제공하는 불변 클래스에서는 불필요한 객체 생성을 피할 수 있다.
  - `Boolean`의 경우 생성자대신 `Boolean.valueOf`를 사용하는것이 좋다.
  - 심지어 자바9에서 생성자는 deprecated 됐다.
- 생성 비용이 비싼 객체의 경우 `캐싱`하는 것을 권한다.
- 예를들어 아래의 코드를 보자
```java
public class Utils {
    public static boolean isRomanNumeral(String s) {
        return s.matches("some regex");
    }
}
```
- 위 코드의 문제는, matches를 통해 전달되는 정규식이 내부에서 파싱되어 Pattern 객체가 되고, 메소드 실행완료 후 바로 버려지는 점이다.
- Pattern의 경우 내부적으로 정규식 처리과정에 의해 생성비용이 비싸기 때문에 위 방법은 좋은 방법이라 할 수 없다.
- 아래 캐싱 방식을 활용해 불필요한 객체 생성없이 재사용하도록 개선한 코드이다.
```java
public class Utils {
    private static final Pattern REGEX = Pattern.compile("some regex");

    public static boolean isRomanNumeral(String s) {
        r\eturn REGEX.matcher(s).matches();
    }
}
```
#### \#2. 객체 캐싱
- Map의 경우 keySet() 메소드 호출 시 해당 맵의 모든 키를 담은 Set 타입 뷰 객체를 반환한다.
- 이도 매번 새로 생성할 수 있지만, 그럴 필요가 없고 이득도 없다.
- 오토박싱의 경우도 마찬가지로 기본형 타입과 섞이면 불필요한 박싱된 객체가 다량으로 생성될 수 있으니 주의하자.
- **박싱된 기본 타입 보다는 기본 타입을 사용하고, 의도치 않은 오토박싱이 숨어들지 않도록 주의**하자.

#### \#3. 오해하지 말 것
- 단순히 `객체 생성은 비싸니 피해야한다.`가 아니다.
- 프로그램의 간결성, 기능을 위해 객체를 추가로 생성하는 것은 일반적으로 좋은 일이다.
- 반대로 아주 무거운 객체가 아니면, 단순히 객체 생성을 피하고자 객체 풀(Pool)을 만들지 말자.
- DBCP의 경우 커넥션 생성 비용이 워낙 비싸다보니 재샤용이 필수지만, 그렇지 않고서야 코드를 헷갈리게 하고 메모리 사용량만 늘릴뿐이다.
- 요즘 JVM의 성능이 가벼운 객체들의 객체 풀링보다 우수하기 때문
- 방어적 복사가 필요한 상황에서 객체를 재사용했을때가 객체를 반복 생성했을때의 피해보다 훨씬 크다.
  - 방어적 복사 실패는 버그, 보안 구멍
  - 반복 객체 생성 - 코드 형태 및 성능에 영향